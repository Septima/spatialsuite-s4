<?xml version="1.0" encoding="UTF-8"?>
<!-- Creates a Find nearest section in detail view -->

<!-- Do not customize this tool. Make a copy of the tool and create your own tool -->
<!-- Look for Customize HERE -->
<tool type="plugin">
    <requires>
    [if: ModuleDefined("s4") ]
    	<include src="[module:s4.dir]/tools/s4-requires.xml" nodes="/tool/requires/*" mustexist="true"/>
	[endif]
	
   </requires>
    <jssrc/>
    <src><![CDATA[
    [if: ModuleDefined("s4") ]
    	if (_s4Params.indexsearcher && _s4Params.indexsearcher.enabled){
    	
    	  var nearestHandler = new Septima.Search.S4NearestHandler({
            // datasources: "ds_buf_kgb_skoler",
		    s4IndexSearcher: _s4Params.indexsearcher.searcher,
		    buttonText: "NÃ¦rmeste"
		  })
			
			if (_s4Params.dawasearcher && _s4Params.dawasearcher.enabled){
				_s4Params.dawasearcher.searcher.addDetailHandlerDef(nearestHandler);
			}
			
			//_s4Params.indexsearcher.searcher.addDetailHandlerDef(nearestHandler);
			
			if (_s4Params.geosearcher && _s4Params.geosearcher.enabled){
			//	_s4Params.geosearcher.searcher.addDetailHandlerDef(nearestHandler);
			}
			
			if (_s4Params.cvrsearcher && _s4Params.cvrsearcher.enabled){
				_s4Params.cvrsearcher.searcher.addDetailHandlerDef(nearestHandler);
			}
		}
		
	[endif]
    ]]>
    </src>
</tool>
